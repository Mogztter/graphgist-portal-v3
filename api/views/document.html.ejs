<%/*
private fun flattenDocument(document: Document) {
    val hasPreamble = document.findBy(mapOf("context" to ":preamble")).isNotEmpty()
    val offset = if (hasPreamble) {
        2
    } else {
        1
    }
    document.findBy(mapOf("context" to ":section")).filter {
        it.level > 1
    }.reversed().forEach { section ->
        var parentSection = (section.parent as Section)
        parentSection.blocks.remove(section)
        while (parentSection.parent != null && parentSection.parent.context == "section") {
            parentSection = parentSection.parent as Section
        }
        val rubyBlock = section as RubyObjectWrapper
        val ruby = rubyBlock.rubyObject.runtime
        rubyBlock.setRubyProperty("@level", ruby.newFixnum(1))
        document.blocks.add(parentSection.index + offset, section)
    }
}
}
*/%>
<style type="text/css" media="screen">
    @import url("//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css");

    .imageblock .content img {
        max-width: 900px;
        max-height: 300px;
    }

    .deck h3, .deck h4 {
        display: block !important;
        margin-bottom: 8px;
        margin-top: 5px;
    }

    .listingblock {
        margin: 8px;
    }

    .pull-bottom {
        position: relative;
        bottom: 1em;
    }

    .admonitionblock td.icon [class^="fa icon-"] {
        font-size: 2.5em;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, .5);
        cursor: default
    }

    .admonitionblock td.icon .icon-note:before {
        content: "\f05a";
        color: #19407c
    }

    .admonitionblock td.icon .icon-tip:before {
        content: "\f0eb";
        text-shadow: 1px 1px 2px rgba(155, 155, 0, .8);
        color: #111
    }

    .admonitionblock td.icon .icon-warning:before {
        content: "\f071";
        color: #bf6900
    }

    .admonitionblock td.icon .icon-caution:before {
        content: "\f06d";
        color: #bf3400
    }

    .admonitionblock td.icon .icon-important:before {
        content: "\f06a";
        color: #bf0000
    }

    .slide pre code {
       background: transparent !important;
    }
</style>
<style type="text/css" media="screen">
    #editor.maximize-editor .CodeMirror-code {
        font-size: 40px;
        line-height: 45px;
    }
</style>
<article class="guide">
    <carousel class="deck container-fluid">
        <% node.blocks.forEach(function (block, index) { %>
            <slide class="row-fluid">
                <div class="col-sm-12">
                    <% if (index === 0 && block.context === 'preamble') { %>
                        <h3><%- node.getDoctitle() %></h3>
                    <% } %>
                    <% if (block.title) { %>
                        <h3><%- block.title %></h3>
                        <br/>
                    <% } %>
                    <%- block.getContent() %>
                </div>
            </slide>
        <% }); %>
    </carousel>
</article>
