= Bollywood Social Analysis
:author: Ashwani Gupta
:twitter: @ashwanigupta51
:style: red:Person(name)

// Please use the style & syntax-help outlined here: https://github.com/neo4j-contrib/graphgist/blob/master/gists/syntax.adoc
// This is also a good example for a GraphGist: https://gist.github.com/jexp/2014efa6448b307c65e9

== Introduction

The example graph consists of characters in IMDB Top 100 Bollywood Movies till 2016 - the Indian Hollywood. Key nodes - Movie and Person
Person comprise of Actors and Movie Directors. We will try to find out some key chacterstics and see some intersting pattern emerging out.

////
Provide an introduction to your domain and what you are trying to accomplish, link to http://a.source.com[sources] as needed.

Provide a domain model image - using something like http://www.apcjones.com/arrows/# or https://www.gliffy.com/ or a readable screenshot from Neo4j-Browser.

You can run this query to get an overview of entities and how they are related:
MATCH (a)-[r]->(b) WHERE labels(a) <> [] AND labels(b) <> []
RETURN DISTINCT head(labels(a)) AS This, type(r) as To, head(labels(b)) AS That LIMIT 10
////


== Setup

////
A Cypher query to setup the database
Please use a small sample of your domain, at most 150 nodes and 200 relationships are enough for the pedagocial example.
You can link to the setup of a larger dataset or LOAD CSV queries in a second file of your GitHub Gist at the end.
In your setup query you can also use LOAD CSV loading CSV files from your GitHub Gist, like here: https://gist.github.com/jexp/f78df7b232d0faa171ff
////

//setup
//hide
[source,cypher]
----
LOAD CSV WITH HEADERS FROM "https://gist.github.com/theashwanigupta/bb8642c9f72e91aab77b29eda5d5d5ed/raw/60896a84ceea97ab1381da3c3ea1f17a05a92c9a/Indian_movies.csv" AS row
MERGE (m:Movie {Title:row.Title}) ON CREATE SET m.Ranking = toInteger(row.Ranking), m.Genres = row.Genres,m.ReleaseDate = row.ReleaseDate
,m.Language = row.Language,m.Rating = row.Rating,m.Runtime = row.Runtime
foreach (pers in split(row.Actor,";") |
MERGE (p:Person {name:pers})
CREATE (p)-[:ACTOR_OF ]->(m))
MERGE (p:Person {name:row.Director})
CREATE (p)-[:DIRECTOR_OF]->(m)
----

== Data Model

// REMOVEME: Describe what this use-case is solving and how the query represents that

// REMOVEME: A Cypher query with tabular output, returning scalar values

//setup
//hide
//output
[source,cypher]
----
MATCH (a)-[r]->(b) WHERE labels(a) <> [] AND labels(b) <> []
RETURN DISTINCT head(labels(a)) AS This, type(r) as To, head(labels(b)) AS That LIMIT 10

----

//table

== Lets look at the overall Graph Model

// REMOVEME: Describe what this use-case is solving and how the query represents that

// REMOVEME: A Cypher query to with graph output

[source,cypher]
----
match (m:Movie)<-[r]-(p) return m,r,p ORDER BY m.Rating desc limit 200
----

//graph_result

////
// You can also use both graph_result and then table if you return full nodes, relationships or paths
////

== Top 10 Actor with most movies in top 100:
// REMOVEME: add as many use-cases as make sense

// optional section
[source,cypher]
----
MATCH (n:Person)-[:ACTOR_OF]->(m:Movie) RETURN n.name, COUNT(m) AS score ORDER BY score DESC limit 10
----
//table


== Top 10 Director with most movies in top 100:
// REMOVEME: add as many use-cases as make sense

// optional section
[source,cypher]
----
MATCH (n:Person)-[:DIRECTOR_OF]->(m:Movie) RETURN n.name, COUNT(m) AS score ORDER BY score DESC limit 10
----
//table
// optional section

== With how many Actors Shah_Rukh_Khan connected to:
// REMOVEME: add as many use-cases as make sense

// optional section
[source,cypher]
----
match(n:Person{name:'Shah_Rukh_Khan'})-[:ACTOR_OF]->(m:Movie) <-[:ACTOR_OF]-(k:Person) return count(k.name)
----
//table
// optional section

== Year with counts of movie in desc order
// REMOVEME: add as many use-cases as make sense

// optional section
[source,cypher]
----
match(m:Movie) return m.ReleaseDate,count(*) order by count(*) desc
----
//table
// optional section

== No of Comedy Movies:
// REMOVEME: add as many use-cases as make sense

// optional section
[source,cypher]
----
MATCH (m:Movie) where toLower(m.Genres) contains 'comedy' return count(m)
----
//table
// optional section

== All Directors that are Actors as well and their movies:
// REMOVEME: add as many use-cases as make sense

// optional section
[source,cypher]
----
match (n:Movie)<-[r:DIRECTOR_OF]-(p:Person)-[q:ACTOR_OF]->(m:Movie) return n,r,p,q,m
----
//graph_result
// optional section

== Display all the movies where person directed and acted both:
// REMOVEME: add as many use-cases as make sense

// optional section
[source,cypher]
----
match (n:Movie)<-[r:DIRECTOR_OF]-(p:Person)-[q:ACTOR_OF]->(n:Movie) return n,r,p,q
----
//graph_result
// optional section

== Conclusion

Shahrukh Khan and Amitabh Bachchan being the top actors having almost 10% of top 100 Movies which is a phenomenal number.
Anurag_Kashyap is the top directors.

== Resources

IMDB

// optional Footer
---


